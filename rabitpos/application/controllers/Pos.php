<?php
 defined("\102\x41\123\x45\120\101\124\x48") or die("\x4e\157\40\x64\151\x72\145\x63\x74\x20\x73\143\162\151\x70\164\40\x61\x63\143\x65\163\163\40\x61\x6c\154\x6f\x77\x65\x64"); class Pos extends MY_Controller { public function __construct() { parent::__construct(); $this->load_global(); $this->load->model("\x70\x6f\163\137\155\157\144\x65\154", "\x70\x6f\x73\x5f\155\157\144\145\x6c"); $this->load->helper("\163\x6d\163\137\164\x65\x6d\x70\154\x61\164\x65\137\x68\x65\154\160\145\x72"); } public function is_sms_enabled() { return is_sms_enabled(); } public function index() { $this->permission_check("\x70\x6f\x73"); $data = $this->data; $data["\160\x61\147\x65\x5f\164\x69\164\x6c\x65"] = "\x50\x4f\x53"; $data["\162\x65\x73\x75\154\164"] = $this->get_hold_invoice_list(); $data["\x74\x6f\164\137\x63\x6f\165\156\x74"] = $this->get_hold_invoice_count(); $this->load->view("\160\x6f\163", $data); } public function newcustomer() { $this->form_validation->set_rules("\x63\165\x73\164\157\155\x65\162\x5f\x6e\141\x6d\x65", "\x43\x75\163\x74\x6f\155\x65\162\x20\x4e\x61\x6d\145", "\164\162\151\155\174\162\145\161\165\x69\162\145\x64"); if ($this->form_validation->run() == TRUE) { $this->load->model("\x63\165\163\164\x6f\155\145\162\163\x5f\x6d\x6f\144\x65\x6c"); $result = $this->customers_model->verify_and_save(); $res = array(); $query = $this->db->query("\163\145\154\x65\x63\164\40\x69\144\54\143\165\163\164\157\155\x65\162\x5f\156\x61\x6d\145\40\x66\162\157\155\40\144\x62\x5f\143\x75\163\164\157\155\x65\162\163\x20\x6f\x72\x64\145\162\40\x62\x79\40\x69\144\x20\144\x65\x73\x63\40\x6c\x69\155\x69\164\x20\x31"); $res["\x69\144"] = $query->row()->id; $res["\143\165\x73\164\157\x6d\145\x72\137\x6e\141\x6d\145"] = $query->row()->customer_name; $res["\x72\145\x73\165\x6c\164"] = $result; echo json_encode($res); } else { echo "\120\154\x65\x61\163\x65\x20\x46\x69\154\154\40\x43\157\155\160\165\154\x73\157\162\171\50\52\40\155\x61\162\153\x65\x64\51\x20\x46\x69\x65\154\144\x73\56"; } } public function get_details() { echo $this->pos_model->get_details(); } public function receive_order() { echo $this->pos_model->receive_order(); } public function pos_save_update() { $result = ''; if ($this->input->post("\143\x6f\x6d\x6d\x61\156\x64") == "\x75\x70\144\141\x74\x65") { $result = $this->pos_model->pos_save_update(); } else { $result = $this->pos_model->pos_save_update(); $result = $result . "\x3c\x3c\x3c\43\x23\43\x3e\x3e\76" . $this->pos_model->hold_invoice_list(); $q1 = $this->db->query("\123\x45\114\x45\x43\124\x20\52\x20\106\122\117\x4d\x20\x64\142\137\x68\x6f\154\144"); $data["\164\157\164\137\x63\x6f\x75\156\x74"] = $q1->num_rows(); $result = $result . "\74\74\x3c\x23\43\x23\x3e\x3e\x3e" . $q1->num_rows(); } echo $result; die; } public function edit($sales_id) { $this->permission_check("\163\x61\x6c\x65\163\137\x65\x64\151\164"); $data = $this->data; $data["\163\141\x6c\145\163\x5f\x69\x64"] = $sales_id; $data["\x70\141\147\145\137\x74\x69\x74\x6c\x65"] = "\120\x4f\123\40\125\x70\x64\x61\164\145"; $data["\x72\x65\163\x75\154\164"] = $this->get_hold_invoice_list(); $data["\x74\x6f\164\137\143\x6f\165\156\x74"] = $this->get_hold_invoice_count(); $data["\x63\165\163\x74\157\155\x65\x72\x5f\151\144"] = get_sales_details($sales_id)->customer_id; $this->load->view("\x70\x6f\x73", $data); } public function fetch_sales($sales_id) { $result = $this->pos_model->edit_pos($sales_id); } public function hold_invoice() { echo $this->pos_model->hold_list_save_update(); } public function hold_invoice_list() { $data = array(); $data["\x72\145\x73\165\154\164"] = $this->get_hold_invoice_list(); $data["\x74\157\164\137\143\157\x75\x6e\x74"] = $this->get_hold_invoice_count(); echo json_encode($data); } public function get_hold_invoice_list() { $data = array(); $result = $this->pos_model->hold_invoice_list(); return $result; } public function get_hold_invoice_count() { $q1 = $this->db->query("\123\x45\114\105\103\x54\x20\x2a\x20\106\x52\x4f\115\40\144\142\137\150\x6f\154\144"); return $q1->num_rows(); } public function hold_invoice_delete($invoice_id) { $result = $this->pos_model->hold_invoice_delete($invoice_id); echo trim($result); } public function hold_invoice_edit() { echo $this->pos_model->hold_invoice_edit(); } public function add_payment_row() { return $this->load->view("\x6d\x6f\x64\141\154\x73\x5f\x70\157\x73\x5f\x70\141\x79\x6d\145\156\164\57\155\x6f\144\x61\x6c\137\x70\141\171\x6d\x65\156\x74\163\x5f\x6d\165\x6c\164\151\137\x73\165\142"); } public function print_invoice_pos($sales_id) { if (!$this->permissions("\163\141\x6c\145\x73\137\141\x64\x64") && !$this->permissions("\163\x61\x6c\145\x73\137\x65\144\x69\x74")) { $this->show_access_denied_page(); } $data = $this->data; $data["\x70\x61\147\x65\137\x74\151\164\x6c\145"] = $this->lang->line("\x73\141\x6c\x65\163\x5f\x69\x6e\x76\157\x69\143\145"); $data = array_merge($data, array("\163\141\154\x65\163\x5f\151\144" => $sales_id)); $this->load->view("\x73\x61\x6c\55\151\x6e\166\157\151\143\x65\x2d\x70\157\163", $data); } public function get_item_details() { echo $this->pos_model->get_item_details($this->input->post("\151\x74\145\x6d\137\151\144")); } public function print_qr($data = '') { $this->load->model("\121\x72\143\x6f\144\145\137\x6d\157\144\145\154", "\x71\162"); return $this->qr->qr_image($data); die; $data = trim($data); $data = base64_decode(str_replace("\x2d", "\x3d", str_replace("\x5f", "\x2f", $data))); $options = new QROptions(array()); return !empty($data) ? "\74\151\155\x67\x20\x73\x72\x63\75\x22" . (new QRCode($options))->render($data) . "\42\40\x61\154\x74\x3d\42\x51\122\x20\103\157\x64\x65\42\x20\x2f\76" : ''; } }